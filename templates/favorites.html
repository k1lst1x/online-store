<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <nav>
        <a href="/">üè† –ì–ª–∞–≤–Ω–∞—è</a>
        <a href="/favorites">‚≠ê –ò–∑–±—Ä–∞–Ω–Ω–æ–µ</a>
    </nav>

    <h1>–ò–∑–±—Ä–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã</h1>
    <div class="products" id="favorites-list">
        <p>–ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ...</p>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            let favorites = JSON.parse(localStorage.getItem("favorites")) || [];

            if (favorites.length === 0) {
                document.getElementById("favorites-list").innerHTML = "<p>–í—ã –µ—â–µ –Ω–µ –¥–æ–±–∞–≤–∏–ª–∏ —Ç–æ–≤–∞—Ä—ã –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ.</p>";
                return;
            }

            fetch("/get_favorites", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ favorites: favorites })
            })
            .then(response => response.json())
            .then(products => {
                let container = document.getElementById("favorites-list");
                container.innerHTML = "";
                products.forEach(product => {
                    let productCard = `
                        <div class="product-card">
                            <img src="${product.image}" alt="${product.name}">
                            <h3>${product.name}</h3>
                            <p>${product.description}</p>
                            <p><strong>${product.price} KZT</strong></p>
                            <button onclick="removeFromFavorites(${product.id})">–£–¥–∞–ª–∏—Ç—å –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ</button>
                        </div>
                    `;
                    container.innerHTML += productCard;
                });
            });
        });

        function removeFromFavorites(productId) {
            let favorites = JSON.parse(localStorage.getItem("favorites")) || [];
            favorites = favorites.filter(id => id !== productId);
            localStorage.setItem("favorites", JSON.stringify(favorites));
            location.reload();
        }
    </script>
</body>
</html>
